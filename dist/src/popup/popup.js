import"../../modulepreload-polyfill.js";class a{constructor(){this.init()}async init(){this.setupEventListeners(),await this.loadStats(),await this.loadMode(),await this.loadCurrentSite()}async loadStats(){try{const e=await chrome.runtime.sendMessage({type:"GET_STATS"});if(e){document.getElementById("time-saved").textContent=this.formatTime(e.timeSaved||0),document.getElementById("prefetched").textContent=e.totalPrefetches||0;const t=e.totalPrefetches>0?Math.round(e.successfulPredictions/e.totalPrefetches*100):"--";document.getElementById("precision").textContent=t==="--"?t:`${t}%`}}catch(e){console.error("Failed to load stats:",e)}}async loadMode(){try{const e=await chrome.runtime.sendMessage({type:"GET_MODE"}),t=(e==null?void 0:e.mode)||"auto";document.querySelectorAll(".mode-btn").forEach(o=>{o.classList.toggle("active",o.dataset.mode===t)})}catch(e){console.error("Failed to load mode:",e)}}async loadCurrentSite(){try{const[e]=await chrome.tabs.query({active:!0,currentWindow:!0});if(e!=null&&e.url){const t=new URL(e.url);document.getElementById("current-domain").textContent=t.hostname;const s=((await chrome.storage.local.get("trustLevels")).trustLevels||{})[t.hostname]||"neutral";document.getElementById("trust-select").value=s}}catch(e){console.error("Failed to load current site:",e)}}setupEventListeners(){document.getElementById("enabled-toggle").addEventListener("change",e=>{chrome.storage.local.set({enabled:e.target.checked})}),document.querySelectorAll(".mode-btn").forEach(e=>{e.addEventListener("click",()=>{const t=e.dataset.mode;chrome.runtime.sendMessage({type:"SET_MODE",mode:t}),document.querySelectorAll(".mode-btn").forEach(o=>o.classList.remove("active")),e.classList.add("active")})}),document.getElementById("trust-select").addEventListener("change",async e=>{const[t]=await chrome.tabs.query({active:!0,currentWindow:!0});if(t!=null&&t.url){const o=new URL(t.url).hostname,s=(await chrome.storage.local.get("trustLevels")).trustLevels||{};s[o]=e.target.value,await chrome.storage.local.set({trustLevels:s})}}),document.getElementById("open-dashboard").addEventListener("click",()=>{chrome.tabs.create({url:chrome.runtime.getURL("src/dashboard/dashboard.html")})}),document.getElementById("open-settings").addEventListener("click",()=>{chrome.tabs.create({url:chrome.runtime.getURL("src/dashboard/dashboard.html#settings")})})}formatTime(e){const t=e/1e3;if(t<60)return`${t.toFixed(1)}s`;const o=Math.floor(t/60),n=t%60;return`${o}m ${n.toFixed(0)}s`}}function r(){new a}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",r):r();
